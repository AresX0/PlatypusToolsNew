<Window x:Class="PlatypusTools.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:PlatypusTools.UI.Views"
        xmlns:vm="clr-namespace:PlatypusTools.UI.ViewModels"
        xmlns:views="clr-namespace:PlatypusTools.UI.Views"
        xmlns:controls="clr-namespace:PlatypusTools.UI.Controls"
        Title="PlatypusTools" Height="700" Width="1200" Icon="Assets/platypus.png">
    <Window.DataContext>
        <vm:MainWindowViewModel />
    </Window.DataContext>
    <Window.Resources>
        <LinearGradientBrush x:Key="HeaderBrush" StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#FF1E88E5" Offset="0"/>
            <GradientStop Color="#FF1565C0" Offset="1"/>
        </LinearGradientBrush>
    </Window.Resources>
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="File">
                <MenuItem Header="Open Folder..." Command="{Binding BrowseCommand}" InputGestureText="Ctrl+O" />
                <Separator />
                <MenuItem Header="Save Workspace..." Command="{Binding SaveWorkspaceCommand}" InputGestureText="Ctrl+S" />
                <MenuItem Header="Export Config..." Command="{Binding ExportConfigCommand}" InputGestureText="Ctrl+Shift+E" />
                <MenuItem Header="Import Config..." Command="{Binding ImportConfigCommand}" InputGestureText="Ctrl+Shift+I" />
                <MenuItem Header="Open Recent..." Command="{Binding OpenRecentWorkspacesCommand}" InputGestureText="Ctrl+R" />
                <Separator />
                <MenuItem Header="Backup Settings..." Click="BackupSettings" />
                <MenuItem Header="Restore Settings..." Click="RestoreSettings" />
                <Separator />
                <MenuItem Header="Exit" Command="{Binding ExitCommand}" InputGestureText="Alt+F4" />
            </MenuItem>
            <MenuItem Header="View">
                <MenuItem Header="Toggle Staging Panel" Command="{Binding ToggleStagingInDuplicatesCommand}" IsCheckable="True" IsChecked="{Binding Duplicates.StagingVisible, Mode=TwoWay}" />
                <MenuItem Header="Show Preview Panel" IsCheckable="True" IsChecked="{Binding Duplicates.PreviewVisible, Mode=TwoWay}" Command="{Binding TogglePreviewPanelCommand}" />
                <Separator />
                <MenuItem Header="Dark Theme" IsCheckable="True" IsChecked="{Binding IsDarkTheme, Mode=TwoWay}" Command="{Binding ToggleThemeCommand}" InputGestureText="Ctrl+Shift+D" />
            </MenuItem>
            <MenuItem Header="Tools">
                <MenuItem Header="Open Archived Scripts" Command="{Binding OpenArchivedScriptsCommand}" />
                <Separator />
                <MenuItem Header="Run Archived Script..." Command="{Binding RunArchivedScriptCommand}" />
                <MenuItem Header="Run Parity Tests..." Command="{Binding RunParityTestsCommand}" />
                <MenuItem Header="Credential Manager..." Command="{Binding OpenCredentialManagerCommand}" />
                <Separator />
                <MenuItem Header="Validate DataContext" Click="ValidateDataContext_Click" />
                <Separator />
                <MenuItem Header="Settings..." Click="OpenSettings" InputGestureText="Ctrl+," />
            </MenuItem>
            <MenuItem Header="Help">
                <MenuItem Header="View Help Documentation" Command="{Binding OpenHelpCommand}" InputGestureText="F1" />
                <Separator />
                <MenuItem Header="File Cleaner - How to Use" Click="ShowFileCleanerHelp" />
                <MenuItem Header="Video Converter - How to Use" Click="ShowVideoConverterHelp" />
                <MenuItem Header="Video Combiner - How to Use" Click="ShowVideoCombinerHelp" />
                <MenuItem Header="Duplicates Finder - How to Use" Click="ShowDuplicatesHelp" />
                <MenuItem Header="System Cleaner - How to Use" Click="ShowSystemCleanerHelp" />
                <MenuItem Header="Folder Hider - How to Use" Click="ShowFolderHiderHelp" />
                <Separator />
                <MenuItem Header="View Logs..." Click="OpenLogViewer" />
                <MenuItem Header="Check for Updates..." Click="CheckForUpdates" />
                <Separator />
                <MenuItem Header="About PlatypusTools" Click="ShowAbout" InputGestureText="Shift+F1" />
            </MenuItem>
        </Menu>

        <Border DockPanel.Dock="Top" Background="{StaticResource HeaderBrush}" Padding="12,8">
            <Grid>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                    <Image Source="Assets/platypus.png" Width="48" Height="48" Margin="0,0,12,0" />
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock FontSize="24" FontWeight="Bold" Foreground="White">PlatypusTools</TextBlock>
                        <TextBlock FontSize="12" Foreground="#FFBBDEFB">Advanced File Management &amp; Media Tools</TextBlock>
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                    <Button Command="{Binding ToggleThemeCommand}" 
                            Width="100" Height="32" Margin="0,0,8,0"
                            Background="#80FFFFFF" Foreground="#FF1E1E1E" 
                            BorderThickness="0" FontWeight="SemiBold">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸŒ“" FontSize="14" Margin="0,0,6,0"/>
                            <TextBlock Text="{Binding IsDarkTheme, Converter={StaticResource BoolToThemeTextConverter}, FallbackValue='Theme'}"/>
                        </StackPanel>
                    </Button>
                    <Button Content="âš™ Settings" Click="OpenSettings" 
                            Width="90" Height="32"
                            Background="#80FFFFFF" Foreground="#FF1E1E1E" 
                            BorderThickness="0" FontWeight="SemiBold"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Status Bar -->
        <controls:StatusBarControl DockPanel.Dock="Bottom"/>

        <TabControl DockPanel.Dock="Top" Margin="8">
            <TabItem Header="File Cleaner">
                <controls:LazyTabContent ViewType="{x:Type views:FileCleanerView}" ViewDataContext="{Binding FileCleaner}" />
            </TabItem>
            <TabItem Header="Media Conversion">
                <TabControl>
                    <TabItem Header="Video Converter">
                        <controls:LazyTabContent ViewType="{x:Type views:VideoConverterView}" ViewDataContext="{Binding VideoConverter}" />
                    </TabItem>
                    <TabItem Header="Video Combiner">
                        <controls:LazyTabContent ViewType="{x:Type views:VideoCombinerView}" ViewDataContext="{Binding VideoCombiner}" />
                    </TabItem>
                    <TabItem Header="Image Converter">
                        <controls:LazyTabContent ViewType="{x:Type views:ImageConverterView}" ViewDataContext="{Binding ImageConverter}" />
                    </TabItem>
                    <TabItem Header="Image Resizer">
                        <controls:LazyTabContent ViewType="{x:Type views:ImageResizerView}" ViewDataContext="{Binding ImageResizer}" />
                    </TabItem>
                    <TabItem Header="ICO Converter">
                        <controls:LazyTabContent ViewType="{x:Type views:IconConverterView}" ViewDataContext="{Binding IconConverter}" />
                    </TabItem>
                    <TabItem Header="Upscaler">
                        <controls:LazyTabContent ViewType="{x:Type views:UpscalerView}" ViewDataContext="{Binding Upscaler}" />
                    </TabItem>
                    <TabItem Header="Batch Upscale">
                        <controls:LazyTabContent ViewType="{x:Type views:BatchUpscaleView}" ViewDataContext="{Binding BatchUpscale}" />
                    </TabItem>
                    <TabItem Header="Bootable USB Creator">
                        <controls:LazyTabContent ViewType="{x:Type views:BootableUSBView}" ViewDataContext="{Binding BootableUSB}" />
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Header="Duplicates">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="300" />
                    </Grid.ColumnDefinitions>
                    <controls:LazyTabContent Grid.Column="0" ViewType="{x:Type views:DuplicatesView}" ViewDataContext="{Binding Duplicates}" />
                    <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                        <Border BorderBrush="Gray" BorderThickness="1" Padding="8" Background="{DynamicResource WindowBackgroundBrush}">
                            <StackPanel>
                                <TextBlock FontWeight="Bold">Auxiliary</TextBlock>
                                <ContentControl Content="{Binding Duplicates.LastPreviewedFilePath}">
                                    <ContentControl.ContentTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" TextWrapping="Wrap" />
                                        </DataTemplate>
                                    </ContentControl.ContentTemplate>
                                </ContentControl>
                                <views:PreviewPanel DataContext="{Binding Duplicates}" Visibility="{Binding Duplicates.PreviewVisible, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                <views:StagingPanel DataContext="{Binding Duplicates.Staging}" Visibility="{Binding Duplicates.StagingVisible, Converter={StaticResource BooleanToVisibilityConverter}}" />
                            </StackPanel>
                        </Border>
                    </ScrollViewer>
                </Grid>
            </TabItem>
                        <!-- Removed QuickActionsView reference due to missing definition -->
            <TabItem Header="Cleanup">
                <TabControl>
                    <TabItem Header="Recent Cleaner">
                        <controls:LazyTabContent ViewType="{x:Type views:RecentCleanupView}" ViewDataContext="{Binding Recent}" />
                    </TabItem>
                    <TabItem Header="Disk Cleanup">
                        <controls:LazyTabContent ViewType="{x:Type views:DiskCleanupView}" ViewDataContext="{Binding DiskCleanup}" />
                    </TabItem>
                    <TabItem Header="Privacy Cleaner">
                        <controls:LazyTabContent ViewType="{x:Type views:PrivacyCleanerView}" ViewDataContext="{Binding PrivacyCleaner}" />
                    </TabItem>
                    <TabItem Header="Empty Folder Scanner">
                        <controls:LazyTabContent ViewType="{x:Type views:EmptyFolderScannerView}" ViewDataContext="{Binding EmptyFolderScanner}" />
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Header="Security">
                <TabControl>
                    <TabItem Header="Folder Hider">
                        <controls:LazyTabContent ViewType="{x:Type views:HiderView}" ViewDataContext="{Binding Hider}" />
                    </TabItem>
                    <TabItem Header="System Audit">
                        <controls:LazyTabContent ViewType="{x:Type views:SystemAuditView}" ViewDataContext="{Binding SystemAudit}" />
                    </TabItem>
                    <TabItem Header="Startup Manager">
                        <controls:LazyTabContent ViewType="{x:Type views:StartupManagerView}" ViewDataContext="{Binding StartupManager}" />
                    </TabItem>
                </TabControl>
            </TabItem>
            <TabItem Header="Metadata">
                <controls:LazyTabContent ViewType="{x:Type views:MetadataEditorView}" ViewDataContext="{Binding MetadataEditor}" />
            </TabItem>
            <TabItem Header="Multimedia Editor">
                <controls:LazyTabContent ViewType="{x:Type views:MultimediaEditorView}" ViewDataContext="{Binding MultimediaEditor}" />
            </TabItem>
            <TabItem Header="ðŸŽµ Audio Player">
                <controls:LazyTabContent ViewType="{x:Type views:AudioPlayerView}" ViewDataContext="{Binding AudioPlayer}" />
            </TabItem>
            <TabItem Header="Tools">
                <TabControl>
                    <TabItem Header="Website Downloader">
                        <controls:LazyTabContent ViewType="{x:Type views:WebsiteDownloaderView}" ViewDataContext="{Binding WebsiteDownloader}" />
                    </TabItem>
                    <TabItem Header="File Analyzer">
                        <controls:LazyTabContent ViewType="{x:Type views:FileAnalyzerView}" ViewDataContext="{Binding FileAnalyzer}" />
                    </TabItem>
                    <TabItem Header="Disk Space Analyzer">
                        <controls:LazyTabContent ViewType="{x:Type views:DiskSpaceAnalyzerView}" ViewDataContext="{Binding DiskSpaceAnalyzer}" />
                    </TabItem>
                    <TabItem Header="Network Tools">
                        <controls:LazyTabContent ViewType="{x:Type views:NetworkToolsView}" ViewDataContext="{Binding NetworkTools}" />
                    </TabItem>
                    <TabItem Header="Process Manager">
                        <controls:LazyTabContent ViewType="{x:Type views:ProcessManagerView}" ViewDataContext="{Binding ProcessManager}" />
                    </TabItem>
                    <TabItem Header="Registry Cleaner">
                        <controls:LazyTabContent ViewType="{x:Type views:RegistryCleanerView}" ViewDataContext="{Binding RegistryCleaner}" />
                    </TabItem>
                    <TabItem Header="Scheduled Tasks">
                        <controls:LazyTabContent ViewType="{x:Type views:ScheduledTasksView}" ViewDataContext="{Binding ScheduledTasks}" />
                    </TabItem>
                    <TabItem Header="System Restore">
                        <controls:LazyTabContent ViewType="{x:Type views:SystemRestoreView}" ViewDataContext="{Binding SystemRestore}" />
                    </TabItem>
                    <TabItem Header="Archive Manager">
                        <controls:LazyTabContent ViewType="{x:Type views:ArchiveManagerView}" ViewDataContext="{Binding ArchiveManager}" />
                    </TabItem>
                    <TabItem Header="PDF Tools">
                        <controls:LazyTabContent ViewType="{x:Type views:PdfToolsView}" ViewDataContext="{Binding PdfTools}" />
                    </TabItem>
                    <TabItem Header="Batch Watermark">
                        <controls:LazyTabContent ViewType="{x:Type views:BatchWatermarkView}" ViewDataContext="{Binding BatchWatermark}" />
                    </TabItem>
                    <TabItem Header="Screenshot">
                        <controls:LazyTabContent ViewType="{x:Type views:ScreenshotView}" ViewDataContext="{Binding Screenshot}" />
                    </TabItem>
                </TabControl>
            </TabItem>
        </TabControl>
    </DockPanel>
</Window>




