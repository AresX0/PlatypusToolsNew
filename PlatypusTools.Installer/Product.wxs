<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
     xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
  
  <Package Name="PlatypusTools"
           Manufacturer="PlatypusTools"
           Version="3.3.2.8"
           UpgradeCode="A1B2C3D4-E5F6-4A5B-9C8D-1E2F3A4B5C6D"
           InstallerVersion="500"
           Compressed="yes"
           Scope="perMachine">

    <SummaryInformation Keywords="Installer"
                        Description="PlatypusTools - Comprehensive System Utilities Suite"
                        Manufacturer="PlatypusTools" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed."
                   AllowSameVersionUpgrades="yes"
                   Schedule="afterInstallInitialize" />

    <!-- Launch conditions -->
    <Launch Condition="VersionNT64" Message="This application requires a 64-bit version of Windows." />

    <MediaTemplate EmbedCab="yes" />

    <!-- Icon for Add/Remove Programs -->
    <Icon Id="PlatypusIcon" SourceFile="..\JosephThePlatypus.ico" />
    <Property Id="ARPPRODUCTICON" Value="PlatypusIcon" />
    <Property Id="ARPURLINFOABOUT" Value="https://github.com/AresX0/PlatypusTools" />

    <!-- Features -->
    <Feature Id="ProductFeature" Title="PlatypusTools" Level="1">
      <ComponentGroupRef Id="PublishFiles" />
      <ComponentGroupRef Id="SupportFiles" />
      <ComponentRef Id="ApplicationShortcut" />
      <ComponentRef Id="RegistryEntries" />
    </Feature>

    <!-- Standard WiX UI -->
    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />
    
    <ui:WixUI Id="WixUI_Minimal" />
  </Package>
</Wix>



