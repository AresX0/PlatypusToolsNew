<UserControl x:Class="PlatypusTools.UI.Views.AudioVisualizerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             mc:Ignorable="d"
             d:DesignHeight="300" 
             d:DesignWidth="600"
             Background="#1E1E1E"
             Foreground="#FFFFFF">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Visualizer Canvas -->
        <Canvas 
            x:Name="VisualizerCanvas" 
            Grid.Row="0"
            Background="#0A0E27"
            Opacity="{Binding VisualizerOpacity}">
            
            <!-- Placeholder for real visualizer content -->
            <Rectangle 
                Width="{Binding ActualWidth, ElementName=VisualizerCanvas}" 
                Height="{Binding ActualHeight, ElementName=VisualizerCanvas}"
                Fill="#0A0E27"/>
            
            <!-- Spectrum Bars (simplified representation) -->
            <ItemsControl ItemsSource="{Binding SpectrumData}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <Canvas/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Rectangle 
                            Fill="#1E90FF"
                            Opacity="0.7"
                            Height="{Binding}"/>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <!-- Waveform Display (simplified) -->
            <Polyline
                Stroke="#00FF00"
                StrokeThickness="1"
                Opacity="0.5"/>
        </Canvas>

        <!-- Controls -->
        <Border 
            Grid.Row="1"
            Background="#2D2D30"
            Padding="10"
            BorderBrush="#3E3E42"
            BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                
                <!-- Toggle Visualizer -->
                <Button
                    Command="{Binding ToggleVisualizerCommand}"
                    Background="Transparent"
                    Foreground="#FFFFFF"
                    Padding="8"
                    Margin="0,0,10,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock 
                            Text="{Binding IsVisualizerEnabled, StringFormat='{}Visualizer: {0}'}"
                            VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <!-- Preset Selection -->
                <TextBlock 
                    Text="Preset:" 
                    VerticalAlignment="Center"
                    Margin="10,0,5,0"/>
                
                <ComboBox
                    ItemsSource="{Binding AvailablePresets}"
                    SelectedItem="{Binding SelectedPreset}"
                    Background="#3C3C3C"
                    Foreground="#FFFFFF"
                    Padding="8,4"
                    MinWidth="150"
                    Margin="0,0,10,0"/>

                <!-- Opacity Slider -->
                <TextBlock 
                    Text="Opacity:" 
                    VerticalAlignment="Center"
                    Margin="10,0,5,0"/>
                
                <Slider
                    Value="{Binding VisualizerOpacity}"
                    Minimum="0.1"
                    Maximum="1.0"
                    Width="100"
                    VerticalAlignment="Center"
                    Margin="0,0,10,0"/>

                <!-- Bar Count -->
                <TextBlock 
                    Text="Bars:" 
                    VerticalAlignment="Center"
                    Margin="10,0,5,0"/>
                
                <Slider
                    Value="{Binding BarCount}"
                    Minimum="8"
                    Maximum="128"
                    Width="100"
                    VerticalAlignment="Center"
                    IsSnapToTickEnabled="True"
                    TickFrequency="8"/>

                <Grid Width="*"/>

                <!-- Info Text -->
                <TextBlock 
                    Text="Audio Visualizer (powered by projectM)" 
                    VerticalAlignment="Center"
                    Foreground="#808080"
                    FontSize="11"
                    Margin="10,0,0,0"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
