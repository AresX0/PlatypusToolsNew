<Window x:Class="PlatypusTools.UI.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings" Height="600" Width="800"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource WindowBackgroundBrush}"
        Foreground="{DynamicResource WindowForegroundBrush}">
    
    <Grid Background="{DynamicResource WindowBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="{DynamicResource PrimaryBrush}" Padding="20">
            <TextBlock Text="âš™ Settings" FontSize="24" FontWeight="Bold" Foreground="White"/>
        </Border>
        
        <!-- Content -->
        <Grid Grid.Row="1" Margin="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="200"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Navigation -->
            <ListBox x:Name="NavList" Grid.Column="0" 
                     Background="{DynamicResource SurfaceBrush}"
                     BorderThickness="0"
                     SelectionChanged="NavList_SelectionChanged">
                <ListBoxItem Tag="General" IsSelected="True">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="âš™" Width="24"/>
                        <TextBlock Text="General"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="Appearance">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸŽ¨" Width="24"/>
                        <TextBlock Text="Appearance"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="Keyboard">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="âŒ¨" Width="24"/>
                        <TextBlock Text="Keyboard Shortcuts"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="AI">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ¤–" Width="24"/>
                        <TextBlock Text="AI Features"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="Visualizer">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸŽ¨" Width="24"/>
                        <TextBlock Text="Audio Visualizer"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="Updates">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ”„" Width="24"/>
                        <TextBlock Text="Updates"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="Backup">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ’¾" Width="24"/>
                        <TextBlock Text="Backup &amp; Restore"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="TabVisibility">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“‘" Width="24"/>
                        <TextBlock Text="Tab Visibility"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="Dependencies">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ“¦" Width="24"/>
                        <TextBlock Text="Dependencies"/>
                    </StackPanel>
                </ListBoxItem>
                <ListBoxItem Tag="Advanced">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ”§" Width="24"/>
                        <TextBlock Text="Advanced"/>
                    </StackPanel>
                </ListBoxItem>
            </ListBox>
            
            <!-- Settings Panels -->
            <ScrollViewer Grid.Column="1" Padding="20">
                <Grid>
                    <!-- General Settings -->
                    <StackPanel x:Name="GeneralPanel">
                        <TextBlock Text="General Settings" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="Startup" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="StartWithWindowsCheck" Content="Start with Windows" Margin="0,4"/>
                                <CheckBox x:Name="StartMinimizedCheck" Content="Start minimized" Margin="0,4"/>
                                <CheckBox x:Name="RestoreLastSessionCheck" Content="Restore last session" Margin="0,4"/>
                                <CheckBox x:Name="RequireAdminRightsCheck" Content="Launch with administrator rights" IsChecked="True" Margin="0,4"
                                          ToolTip="When enabled, the application will request administrator privileges on startup. Change takes effect after restart."/>
                                <TextBlock Text="â†³ Restart required for admin rights change to take effect" 
                                           FontSize="11" Foreground="{DynamicResource ForegroundDimBrush}" Margin="20,2,0,0"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="File Operations" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="ConfirmDeleteCheck" Content="Confirm before deleting files" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="UseRecycleBinCheck" Content="Move deleted files to Recycle Bin" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="ShowPreviewCheck" Content="Show preview before applying changes" IsChecked="True" Margin="0,4"/>
                                
                                <Grid Margin="0,8,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Undo history limit:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="UndoLimitText" Grid.Column="1" Text="100" Margin="8,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Logging">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="EnableLoggingCheck" Content="Enable application logging" IsChecked="True" Margin="0,4"/>
                                <Grid Margin="0,8,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Log level:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="LogLevelCombo" Grid.Column="1" Margin="8,0,0,0" Width="150" HorizontalAlignment="Left">
                                        <ComboBoxItem Content="Debug"/>
                                        <ComboBoxItem Content="Info" IsSelected="True"/>
                                        <ComboBoxItem Content="Warning"/>
                                        <ComboBoxItem Content="Error"/>
                                    </ComboBox>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                    
                    <!-- Appearance Settings -->
                    <StackPanel x:Name="AppearancePanel" Visibility="Collapsed">
                        <TextBlock Text="Appearance" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="Theme" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <RadioButton x:Name="LightThemeRadio" Content="Light" GroupName="Theme" IsChecked="True" Margin="0,4"/>
                                <RadioButton x:Name="DarkThemeRadio" Content="Dark" GroupName="Theme" Margin="0,4"/>
                                <RadioButton x:Name="LCARSThemeRadio" Content="LCARS (Star Trek)" GroupName="Theme" Margin="0,4"/>
                                <RadioButton x:Name="KlingonThemeRadio" Content="Klingon (tlhIngan)" GroupName="Theme" Margin="0,4"/>
                                <RadioButton x:Name="PipBoyThemeRadio" Content="Pip-Boy (Fallout)" GroupName="Theme" Margin="0,4"/>
                                <RadioButton x:Name="SystemThemeRadio" Content="Use system setting" GroupName="Theme" Margin="0,4"/>
                                <Button Content="Customize Theme..." MinWidth="190" HorizontalAlignment="Left" Margin="0,12,0,0" Click="CustomizeTheme_Click"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Aero Glass Effect (Windows 10/11)" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="GlassEffectCheck" Content="Enable Aero Glass transparency" Margin="0,4" 
                                          Checked="GlassEffectCheck_Changed" Unchecked="GlassEffectCheck_Changed"/>
                                <StackPanel Orientation="Horizontal" Margin="0,8,0,4">
                                    <TextBlock Text="Glass Intensity:" VerticalAlignment="Center" Width="100"/>
                                    <ComboBox x:Name="GlassLevelCombo" Width="150" SelectionChanged="GlassLevelCombo_SelectionChanged">
                                        <ComboBoxItem Content="Off" Tag="Off"/>
                                        <ComboBoxItem Content="Subtle" Tag="Low"/>
                                        <ComboBoxItem Content="Medium" Tag="Medium" IsSelected="True"/>
                                        <ComboBoxItem Content="Strong" Tag="High"/>
                                        <ComboBoxItem Content="Auto (System)" Tag="Auto"/>
                                    </ComboBox>
                                </StackPanel>
                                <TextBlock Text="Note: Glass effects require Windows 10 version 1803 or later" 
                                           FontSize="11" Foreground="{DynamicResource ForegroundDimBrush}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Display" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="ShowStatusBarCheck" Content="Show status bar" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="ShowToolbarCheck" Content="Show toolbar" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="AnimationsCheck" Content="Enable animations" IsChecked="True" Margin="0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Font Settings" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <TextBlock Text="Custom font overrides the theme default. Fonts must be installed on your system." 
                                           TextWrapping="Wrap" FontSize="11" Foreground="{DynamicResource ForegroundDimBrush}" Margin="0,0,0,8"/>
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                    <TextBlock Text="Font Family:" VerticalAlignment="Center" Width="100"/>
                                    <ComboBox x:Name="FontFamilyCombo" Width="200" SelectionChanged="FontFamilyCombo_SelectionChanged">
                                        <ComboBoxItem Content="Default (Theme)" Tag="Default" IsSelected="True"/>
                                        <ComboBoxItem Content="Segoe UI" Tag="Segoe UI"/>
                                        <ComboBoxItem Content="Consolas" Tag="Consolas"/>
                                        <ComboBoxItem Content="Arial" Tag="Arial"/>
                                        <ComboBoxItem Content="Klingon Font" Tag="klingon font"/>
                                        <ComboBoxItem Content="Okuda (LCARS)" Tag="Okuda"/>
                                        <ComboBoxItem Content="Monofonto (Pip-Boy)" Tag="Monofonto"/>
                                        <ComboBoxItem Content="Overseer" Tag="Overseer"/>
                                    </ComboBox>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <TextBlock Text="Font Scale:" VerticalAlignment="Center" Width="100"/>
                                    <Slider x:Name="FontScaleSlider" Minimum="0.5" Maximum="2.0" Value="1.0" Width="150" 
                                            TickFrequency="0.1" IsSnapToTickEnabled="True" 
                                            ValueChanged="FontScaleSlider_ValueChanged"/>
                                    <TextBlock x:Name="FontScaleLabel" Text="100%" Width="50" VerticalAlignment="Center" Margin="8,0,0,0"/>
                                </StackPanel>
                                <TextBlock Text="Scale affects all text proportionally. 100% = default theme sizes." 
                                           FontSize="11" Foreground="{DynamicResource ForegroundDimBrush}" Margin="0,8,0,0"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                    
                    <!-- Keyboard Shortcuts -->
                    <StackPanel x:Name="KeyboardPanel" Visibility="Collapsed">
                        <TextBlock Text="Keyboard Shortcuts" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <DataGrid x:Name="ShortcutsGrid" AutoGenerateColumns="False" 
                                  CanUserAddRows="False" CanUserDeleteRows="False"
                                  CanUserResizeColumns="True" CanUserSortColumns="True"
                                  Height="300">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Command" Binding="{Binding Name}" Width="200" IsReadOnly="True" CanUserResize="True" MinWidth="100"/>
                                <DataGridTextColumn Header="Shortcut" Binding="{Binding Shortcut}" Width="150" CanUserResize="True" MinWidth="80"/>
                                <DataGridTextColumn Header="Description" Binding="{Binding Description}" Width="*" IsReadOnly="True" CanUserResize="True" MinWidth="100"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                            <Button Content="Reset to Defaults" Margin="0,0,8,0" Click="ResetShortcuts_Click"/>
                            <Button Content="Import..." Margin="0,0,8,0"/>
                            <Button Content="Export..."/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- AI Settings -->
                    <StackPanel x:Name="AIPanel" Visibility="Collapsed">
                        <TextBlock Text="AI Features" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="API Configuration" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <Grid Margin="0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Provider:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="AIProviderCombo" Grid.Column="1" Width="200" HorizontalAlignment="Left">
                                        <ComboBoxItem Content="OpenAI" IsSelected="True"/>
                                        <ComboBoxItem Content="Azure OpenAI"/>
                                        <ComboBoxItem Content="Anthropic"/>
                                    </ComboBox>
                                </Grid>
                                
                                <Grid Margin="0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="API Key:" VerticalAlignment="Center"/>
                                    <PasswordBox x:Name="AIApiKeyBox" Grid.Column="1" MaxWidth="400" HorizontalAlignment="Left"/>
                                </Grid>
                                
                                <Grid Margin="0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Model:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="AIModelCombo" Grid.Column="1" Width="200" HorizontalAlignment="Left">
                                        <ComboBoxItem Content="gpt-4" IsSelected="True"/>
                                        <ComboBoxItem Content="gpt-4-turbo"/>
                                        <ComboBoxItem Content="gpt-3.5-turbo"/>
                                    </ComboBox>
                                </Grid>
                                
                                <Button Content="Test Connection" MinWidth="180" HorizontalAlignment="Left" Margin="0,12,0,0" Click="TestAI_Click"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Features">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="AISmartRenameCheck" Content="Enable AI-powered smart rename suggestions" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="AITaggingCheck" Content="Enable AI-powered auto-tagging" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="AIOrganizeCheck" Content="Enable AI-powered file organization" IsChecked="True" Margin="0,4"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                    
                    <!-- Updates Settings -->
                    <StackPanel x:Name="UpdatesPanel" Visibility="Collapsed">
                        <TextBlock Text="Updates" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="Auto Updates" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="AutoCheckUpdatesCheck" Content="Check for updates automatically" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="AutoDownloadUpdatesCheck" Content="Download updates automatically" Margin="0,4"/>
                                <CheckBox x:Name="NotifyUpdatesCheck" Content="Show notification when update is available" IsChecked="True" Margin="0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Current Version">
                            <StackPanel Margin="8">
                                <TextBlock x:Name="CurrentVersionText" Text="Version: 3.3.3.7"/>
                                <TextBlock x:Name="LastCheckText" Text="Last checked: Never" Foreground="Gray" Margin="0,4,0,0"/>
                                <Button Content="Check for Updates Now" MinWidth="180" HorizontalAlignment="Left" Margin="0,12,0,0" Click="CheckUpdates_Click"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                    
                    <!-- Backup Settings -->
                    <StackPanel x:Name="BackupPanel" Visibility="Collapsed">
                        <TextBlock Text="Backup &amp; Restore" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="Backup Settings" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <Button Content="Create Backup..." MinWidth="190" HorizontalAlignment="Left" Margin="0,4" Click="CreateBackup_Click"/>
                                <Button Content="Restore from Backup..." MinWidth="190" HorizontalAlignment="Left" Margin="0,4" Click="RestoreBackup_Click"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Auto Backup">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="AutoBackupCheck" Content="Create automatic backups" Margin="0,4"/>
                                <Grid Margin="0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Backup interval (days):" VerticalAlignment="Center"/>
                                    <TextBox x:Name="BackupIntervalText" Grid.Column="1" Text="7" Margin="8,0,0,0"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                    <!-- Backup Settings Panel continued -->
                    </StackPanel>
                    
                    <!-- Tab Visibility Settings -->
                    <StackPanel x:Name="TabVisibilityPanel" Visibility="Collapsed">
                        <TextBlock Text="Tab Visibility" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        <TextBlock Text="Choose which tabs appear in the main window. Changes take effect immediately." 
                                   TextWrapping="Wrap" Margin="0,0,0,16" Foreground="Gray"/>
                        
                        <!-- File Management -->
                        <GroupBox Header="ðŸ“ File Management" Margin="0,0,0,12">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="TabFileManagement" Content="ðŸ“ File Management (entire section)" IsChecked="True" FontWeight="SemiBold" Margin="0,4"/>
                                <CheckBox x:Name="TabFileCleaner" Content="    File Cleaner" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabDuplicates" Content="    Duplicates" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabEmptyFolderScanner" Content="    Empty Folder Scanner" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabRobocopy" Content="    Robocopy" IsChecked="True" Margin="16,4,0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Multimedia -->
                        <GroupBox Header="ðŸŽ¬ Multimedia" Margin="0,0,0,12">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="TabMultimedia" Content="ðŸŽ¬ Multimedia (entire section)" IsChecked="True" FontWeight="SemiBold" Margin="0,4"/>
                                
                                <TextBlock Text="Audio" FontWeight="SemiBold" Margin="16,8,0,4"/>
                                <CheckBox x:Name="TabEnhancedAudioPlayer" Content="    Enhanced Audio Player" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAudioPlayer" Content="    Audio Player" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAudioTrim" Content="    Audio Trim" IsChecked="True" Margin="32,4,0,4"/>
                                
                                <TextBlock Text="Image" FontWeight="SemiBold" Margin="16,8,0,4"/>
                                <CheckBox x:Name="TabImageEdit" Content="    Image Edit" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabImageConverter" Content="    Image Converter" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabImageResizer" Content="    Image Resizer" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabIconConverter" Content="    ICO Converter" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabBatchWatermark" Content="    Batch Watermark" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabImageScaler" Content="    Image Scaler" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabModel3DEditor" Content="    3D Model Editor" IsChecked="True" Margin="32,4,0,4"/>
                                
                                <TextBlock Text="Video" FontWeight="SemiBold" Margin="16,8,0,4"/>
                                <CheckBox x:Name="TabVideoPlayer" Content="    Video Player" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabVideoEditor" Content="    Video Editor" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabUpscaler" Content="    Upscaler" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabVideoCombiner" Content="    Video Combiner" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabVideoConverter" Content="    Video Converter" IsChecked="True" Margin="32,4,0,4"/>
                                
                                <CheckBox x:Name="TabMediaLibrary" Content="    ðŸ“š Media Library" IsChecked="True" Margin="16,8,0,4"/>
                                <CheckBox x:Name="TabExternalTools" Content="    ðŸ”§ External Tools" IsChecked="True" Margin="16,4,0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- System -->
                        <GroupBox Header="ðŸ–¥ï¸ System" Margin="0,0,0,12">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="TabSystem" Content="ðŸ–¥ï¸ System (entire section)" IsChecked="True" FontWeight="SemiBold" Margin="0,4"/>
                                <CheckBox x:Name="TabDiskCleanup" Content="    Disk Cleanup" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabPrivacyCleaner" Content="    Privacy Cleaner" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabRecentCleaner" Content="    Recent Cleaner" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabStartupManager" Content="    Startup Manager" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabProcessManager" Content="    Process Manager" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabRegistryCleaner" Content="    Registry Cleaner" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabScheduledTasks" Content="    Scheduled Tasks" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabSystemRestore" Content="    System Restore" IsChecked="True" Margin="16,4,0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Security -->
                        <GroupBox Header="ðŸ”’ Security" Margin="0,0,0,12">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="TabSecurity" Content="ðŸ”’ Security (entire section)" IsChecked="True" FontWeight="SemiBold" Margin="0,4"/>
                                <CheckBox x:Name="TabFolderHider" Content="    Folder Hider" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabSystemAudit" Content="    System Audit" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabForensicsAnalyzer" Content="    Forensics Analyzer" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabSecureWipe" Content="    Secure Wipe" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabHashScanner" Content="    Hash Scanner" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabRebootAnalyzer" Content="    Reboot Analyzer" IsChecked="True" Margin="16,4,0,4"/>
                                <!-- AD Security Analyzer - shown only when licensed -->
                                <CheckBox x:Name="TabAdSecurityAnalyzer" Content="    ðŸ” AD Security Analyzer (Licensed)" IsChecked="True" Margin="16,4,0,4" Visibility="Collapsed"/>
                                <CheckBox x:Name="TabAdvancedForensics" Content="    ðŸ”¬ Advanced Forensics" IsChecked="True" Margin="16,4,0,4"/>
                                <!-- Advanced Forensics Sub-tabs -->
                                <CheckBox x:Name="TabAdvForensicsMemory" Content="        Memory Analysis" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsArtifacts" Content="        Artifacts" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsTimeline" Content="        Timeline" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsKusto" Content="        Kusto" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsLocalKQL" Content="        Local KQL" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsMalware" Content="        Malware Analysis" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsExtract" Content="        Extract" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsOpenSearch" Content="        OpenSearch" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsOSINT" Content="        OSINT" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsSchedule" Content="        Task Scheduler" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsBrowser" Content="        Browser Forensics" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsIOC" Content="        IOC Scanner" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsRegistry" Content="        Registry Diff" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsPCAP" Content="        PCAP Parser" IsChecked="True" Margin="32,4,0,4"/>
                                <CheckBox x:Name="TabAdvForensicsResults" Content="        Results" IsChecked="True" Margin="32,4,0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Metadata -->
                        <GroupBox Header="ðŸ“‹ Metadata" Margin="0,0,0,12">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="TabMetadata" Content="ðŸ“‹ Metadata" IsChecked="True" FontWeight="SemiBold" Margin="0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <!-- Tools -->
                        <GroupBox Header="ðŸ”§ Tools" Margin="0,0,0,12">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="TabTools" Content="ðŸ”§ Tools (entire section)" IsChecked="True" FontWeight="SemiBold" Margin="0,4"/>
                                <CheckBox x:Name="TabWebsiteDownloader" Content="    Website Downloader" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabFileAnalyzer" Content="    File Analyzer" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabDiskSpaceAnalyzer" Content="    Disk Space Analyzer" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabNetworkTools" Content="    Network Tools" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabArchiveManager" Content="    Archive Manager" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabPdfTools" Content="    PDF Tools" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabScreenshot" Content="    Screenshot" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabBootableUSB" Content="    Bootable USB Creator" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabPluginManager" Content="    Plugin Manager" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabFtpClient" Content="    FTP Client" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabTerminalClient" Content="    Terminal Client" IsChecked="True" Margin="16,4,0,4"/>
                                <CheckBox x:Name="TabSimpleBrowser" Content="    Simple Browser" IsChecked="True" Margin="16,4,0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                            <Button Content="Show All Tabs" MinWidth="180" Margin="0,0,8,0" Click="ShowAllTabs_Click"/>
                            <Button Content="Hide All Tabs" MinWidth="180" Click="HideAllTabs_Click"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Audio Visualizer Settings -->
                    <StackPanel x:Name="VisualizerPanel" Visibility="Collapsed">
                        <TextBlock Text="Audio Visualizer" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="Visualizer Enable" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="EnableVisualizerCheck" Content="Enable audio visualizer" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="ShowVisualizerDuringPlaybackCheck" Content="Show visualizer during playback" IsChecked="True" Margin="0,4"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Visualizer Appearance" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <Grid Margin="0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Preset:" VerticalAlignment="Center"/>
                                    <ComboBox x:Name="VisualizerPresetCombo" Grid.Column="1" Margin="8,0,0,0">
                                        <ComboBoxItem Content="Default" IsSelected="True"/>
                                        <ComboBoxItem Content="Spectrum Analyzer"/>
                                        <ComboBoxItem Content="Waveform"/>
                                        <ComboBoxItem Content="Bars"/>
                                        <ComboBoxItem Content="Circular"/>
                                        <ComboBoxItem Content="Oscilloscope"/>
                                    </ComboBox>
                                </Grid>
                                
                                <Grid Margin="0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Opacity:" VerticalAlignment="Center"/>
                                    <Slider x:Name="VisualizerOpacitySlider" Grid.Column="1" Minimum="0.1" Maximum="1.0" Value="0.9" Margin="8,0"/>
                                    <TextBlock x:Name="OpacityValueText" Grid.Column="2" Text="90%" VerticalAlignment="Center" TextAlignment="Right"/>
                                </Grid>
                                
                                <Grid Margin="0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="60"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Bar Count:" VerticalAlignment="Center"/>
                                    <Slider x:Name="VisualizerBarCountSlider" Grid.Column="1" Minimum="8" Maximum="128" Value="32" 
                                            IsSnapToTickEnabled="True" TickFrequency="8" Margin="8,0"/>
                                    <TextBlock x:Name="BarCountValueText" Grid.Column="2" Text="32" VerticalAlignment="Center" TextAlignment="Right"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Visualizer Colors" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <Grid Margin="0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Primary Color:" VerticalAlignment="Center"/>
                                    <Button x:Name="PrimaryColorButton" Grid.Column="1" Height="30" Background="#1E90FF" ToolTip="Click to change color"/>
                                </Grid>
                                
                                <Grid Margin="0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Background Color:" VerticalAlignment="Center"/>
                                    <Button x:Name="BackgroundColorButton" Grid.Column="1" Height="30" Background="#0A0E27" ToolTip="Click to change color"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Advanced" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="EnableGPUAccelerationCheck" Content="Enable GPU acceleration" IsChecked="True" Margin="0,4"/>
                                <CheckBox x:Name="EnableAudioNormalizationCheck" Content="Normalize audio input" IsChecked="True" Margin="0,4"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                    
                    <!-- Dependencies Settings -->
                    <StackPanel x:Name="DependenciesPanel" Visibility="Collapsed">
                        <TextBlock Text="Dependencies" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        <TextBlock Text="Some features require external tools. Use this section to check and install them." 
                                   TextWrapping="Wrap" Foreground="Gray" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="Dependency Status" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <Grid Margin="0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="30"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock x:Name="DepFFmpegStatus" Text="â³" FontSize="14"/>
                                    <TextBlock Grid.Column="1" Text="FFmpeg" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="DepFFmpegInfo" Grid.Column="2" Text="Checking..." Foreground="Gray"/>
                                    <Button x:Name="DepFFmpegBtn" Grid.Column="3" Content="Install" MinWidth="180" Click="DepInstallFFmpeg_Click"/>
                                </Grid>
                                <Grid Margin="0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="30"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock x:Name="DepExifToolStatus" Text="â³" FontSize="14"/>
                                    <TextBlock Grid.Column="1" Text="ExifTool" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="DepExifToolInfo" Grid.Column="2" Text="Checking..." Foreground="Gray"/>
                                    <Button x:Name="DepExifToolBtn" Grid.Column="3" Content="Install" MinWidth="180" Click="DepInstallExifTool_Click"/>
                                </Grid>
                                <Grid Margin="0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="30"/>
                                        <ColumnDefinition Width="120"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock x:Name="DepWebView2Status" Text="â³" FontSize="14"/>
                                    <TextBlock Grid.Column="1" Text="WebView2" FontWeight="SemiBold"/>
                                    <TextBlock x:Name="DepWebView2Info" Grid.Column="2" Text="Checking..." Foreground="Gray"/>
                                    <Button x:Name="DepWebView2Btn" Grid.Column="3" Content="Install" MinWidth="180" Click="DepInstallWebView2_Click"/>
                                </Grid>
                                <Button Content="ðŸ”„ Refresh Status" MinWidth="180" HorizontalAlignment="Left" Margin="0,12,0,0" Click="DepRefresh_Click"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Installation Options" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <CheckBox x:Name="ShowDependencyPromptCheck" Content="Show dependency setup on startup if tools are missing" IsChecked="True" Margin="0,4"/>
                                <TextBlock Text="When enabled, a setup window will appear on startup if any dependencies are missing." 
                                           Foreground="Gray" FontSize="11" Margin="20,2,0,8"/>
                                <Button Content="Open Dependency Setup Window..." MinWidth="220" HorizontalAlignment="Left" Margin="0,8,0,0" Click="OpenDependencySetup_Click"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Manual Installation">
                            <StackPanel Margin="8">
                                <TextBlock TextWrapping="Wrap" Margin="0,0,0,8">
                                    If automatic installation fails, you can download and install the tools manually:
                                </TextBlock>
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <Button Content="FFmpeg Website â†—" MinWidth="180" Click="DepOpenFFmpegSite_Click"/>
                                    <TextBlock Text="Video editing, screen recording" VerticalAlignment="Center" Foreground="Gray" Margin="12,0,0,0"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,8">
                                    <Button Content="ExifTool Website â†—" MinWidth="180" Click="DepOpenExifToolSite_Click"/>
                                    <TextBlock Text="Metadata editing" VerticalAlignment="Center" Foreground="Gray" Margin="12,0,0,0"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,8">
                                    <Button Content="WebView2 Runtime â†—" MinWidth="180" Click="DepOpenWebView2Site_Click"/>
                                    <TextBlock Text="Help system, browser features" VerticalAlignment="Center" Foreground="Gray" Margin="12,0,0,0"/>
                                </StackPanel>
                                <Button Content="ðŸ“ Open Tools Folder" MinWidth="180" HorizontalAlignment="Left" Margin="0,12,0,0" Click="DepOpenToolsFolder_Click"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                    
                    <!-- Advanced Settings -->
                    <StackPanel x:Name="AdvancedPanel" Visibility="Collapsed">
                        <TextBlock Text="Advanced" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,16"/>
                        
                        <GroupBox Header="Performance" Margin="0,0,0,16">
                            <StackPanel Margin="8">
                                <Grid Margin="0,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="Max concurrent operations:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="MaxConcurrentText" Grid.Column="1" Text="4"/>
                                </Grid>
                                <Grid Margin="0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="200"/>
                                        <ColumnDefinition Width="100"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Text="File scan batch size:" VerticalAlignment="Center"/>
                                    <TextBox x:Name="ScanBatchText" Grid.Column="1" Text="1000"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Data">
                            <StackPanel Margin="8">
                                <Button Content="Clear Recent Files" MinWidth="190" HorizontalAlignment="Left" Margin="0,4" Click="ClearRecent_Click"/>
                                <Button Content="Clear Cache" MinWidth="190" HorizontalAlignment="Left" Margin="0,4" Click="ClearCache_Click"/>
                                <Button Content="Reset All Settings" MinWidth="190" HorizontalAlignment="Left" Margin="0,8" Click="ResetAll_Click"/>
                            </StackPanel>
                        </GroupBox>
                        
                        <GroupBox Header="Custom Fonts" Margin="0,16,0,0">
                            <StackPanel Margin="8">
                                <TextBlock Text="Install custom fonts for themes and visualizers. Fonts are installed system-wide and require admin rights." 
                                           TextWrapping="Wrap" Margin="0,0,0,12"/>
                                
                                <!-- Okuda Font (LCARS) -->
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <Button x:Name="InstallOkudaFontBtn" Content="ðŸ“ Install Okuda Font" 
                                            MinWidth="200" HorizontalAlignment="Left"
                                            Click="InstallOkudaFont_Click"
                                            ToolTip="LCARS theme font - Star Trek computer interface style"/>
                                    <TextBlock x:Name="OkudaFontStatus" Text="" FontSize="11" 
                                               Foreground="{DynamicResource ForegroundDimBrush}" 
                                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                                </StackPanel>
                                
                                <!-- Monofonto Font (PipBoy) -->
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <Button x:Name="InstallMonofontoFontBtn" Content="ðŸ“ Install Monofonto Font" 
                                            MinWidth="200" HorizontalAlignment="Left"
                                            Click="InstallMonofontoFont_Click"
                                            ToolTip="PipBoy theme font - Fallout terminal style"/>
                                    <TextBlock x:Name="MonofontoFontStatus" Text="" FontSize="11" 
                                               Foreground="{DynamicResource ForegroundDimBrush}" 
                                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                                </StackPanel>
                                
                                <!-- Overseer Font -->
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <Button x:Name="InstallOverseerFontBtn" Content="ðŸ“ Install Overseer Font" 
                                            MinWidth="200" HorizontalAlignment="Left"
                                            Click="InstallOverseerFont_Click"
                                            ToolTip="Vault-Tec Overseer style font"/>
                                    <TextBlock x:Name="OverseerFontStatus" Text="" FontSize="11" 
                                               Foreground="{DynamicResource ForegroundDimBrush}" 
                                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                                </StackPanel>
                                
                                <!-- Klingon Font -->
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <Button x:Name="InstallKlingonFontBtn" Content="ðŸ“ Install Klingon Font" 
                                            MinWidth="200" HorizontalAlignment="Left"
                                            Click="InstallKlingonFont_Click"
                                            ToolTip="Klingon theme font for the tlhIngan wo' theme"/>
                                    <TextBlock x:Name="KlingonFontStatus" Text="" FontSize="11" 
                                               Foreground="{DynamicResource ForegroundDimBrush}" 
                                               VerticalAlignment="Center" Margin="8,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </Grid>
            </ScrollViewer>
        </Grid>
        
        <!-- Footer -->
        <Border Grid.Row="2" Background="{DynamicResource SurfaceBrush}" Padding="20,12">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Apply" MinWidth="180" Margin="0,0,8,0" Click="Apply_Click"/>
                <Button Content="OK" MinWidth="180" Margin="0,0,8,0" Click="OK_Click"/>
                <Button Content="Cancel" MinWidth="180" Click="Cancel_Click"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
