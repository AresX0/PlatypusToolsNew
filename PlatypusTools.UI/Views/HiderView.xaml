<UserControl x:Class="PlatypusTools.UI.Views.HiderView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:PlatypusTools.UI.ViewModels"
             mc:Ignorable="d" d:DesignHeight="500" d:DesignWidth="800">
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,8">
            <TextBlock VerticalAlignment="Center" Margin="0,0,8,0">Folder:</TextBlock>
            <TextBox Width="300" Text="{Binding NewFolderPath, UpdateSourceTrigger=PropertyChanged}" />
            <Button Content="Browse..." Command="{Binding BrowseFolderCommand}" MinWidth="90" Margin="8,0,0,0" />
            <Button Content="Add to Hider List" Command="{Binding AddFolderCommand}" MinWidth="140" Margin="8,0,0,0" />
        </StackPanel>

        <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,8">
            <Button Content="Hide Folder" Command="{Binding SetHiddenCommand}" MinWidth="105" />
            <Button Content="Unhide Folder" Command="{Binding ClearHiddenCommand}" MinWidth="120" Margin="8,0,0,0" />
            <Button Content="Restrict to Administrators" Command="{Binding ApplyAclCommand}" MinWidth="195" Margin="8,0,0,0" />
            <Button Content="Load Configuration" Command="{Binding LoadConfigCommand}" MinWidth="150" Margin="8,0,0,0" />
            <Button Content="Save Configuration" Command="{Binding SaveConfigCommand}" MinWidth="150" Margin="8,0,0,0" />
        </StackPanel>

        <ScrollViewer Grid.Row="2" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
            <DataGrid ItemsSource="{Binding Records}" AutoGenerateColumns="False"
                      CanUserResizeColumns="True" CanUserSortColumns="True"
                      ColumnHeaderHeight="32"
                      HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Disabled"
                      ColumnWidth="*">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Folder" Binding="{Binding FolderPath}" Width="300" MinWidth="200" CanUserResize="True" IsReadOnly="True" />
                    <DataGridCheckBoxColumn Header="Hidden" Binding="{Binding IsHidden, Mode=OneWay}" Width="80" MinWidth="60" CanUserResize="True" IsReadOnly="True" />
                    <DataGridCheckBoxColumn Header="Restrict to Administrators" Binding="{Binding AclRestricted, UpdateSourceTrigger=PropertyChanged}" Width="160" MinWidth="140" CanUserResize="True" />
                    <DataGridCheckBoxColumn Header="Use EFS" Binding="{Binding EfsEnabled, UpdateSourceTrigger=PropertyChanged}" Width="100" MinWidth="80" CanUserResize="True" />
                    <DataGridTemplateColumn Header="Actions" Width="300" MinWidth="300">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="Hide" Command="{Binding DataContext.SetHiddenCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" MinWidth="55" Margin="0,0,2,0" Padding="4,2" ToolTip="Hide this folder" />
                                <Button Content="Unhide" Command="{Binding DataContext.ClearHiddenCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" MinWidth="70" Margin="0,0,2,0" Padding="4,2" ToolTip="Unhide this folder" />
                                <Button Content="ACL" Command="{Binding DataContext.ApplyAclCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" MinWidth="50" Margin="0,0,2,0" Padding="4,2" ToolTip="Restrict to Administrators" />
                                <Button Content="EFS" Command="{Binding DataContext.ApplyEfsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" MinWidth="50" Margin="0,0,2,0" Padding="4,2" ToolTip="Apply EFS encryption" />
                                <Button Content="Remove" Command="{Binding DataContext.RemoveRecordCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" MinWidth="80" Padding="4,2" Foreground="Red" ToolTip="Remove from list" />
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
        </ScrollViewer>
    </Grid>
</UserControl>