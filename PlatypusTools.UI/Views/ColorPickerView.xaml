<UserControl x:Class="PlatypusTools.UI.Views.ColorPickerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignHeight="700" d:DesignWidth="1200">
    <Grid Margin="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <TextBlock Text="ðŸŽ¨ Color Picker / Screen Magnifier" FontSize="16" FontWeight="Bold" Margin="0,0,0,8" />

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="300" MinWidth="250" />
            </Grid.ColumnDefinitions>

            <!-- Left: Magnifier + Controls -->
            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                <!-- Pick Color Button -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                    <Button Content="ðŸŽ¯ Pick Color" Command="{Binding PickColorCommand}"
                            Padding="16,8" FontSize="14"
                            Background="#FF4CAF50" Foreground="White" />
                    <TextBlock VerticalAlignment="Center" Margin="12,0,0,0">
                        <Run Text="Position: " Foreground="{DynamicResource SecondaryTextBrush}" />
                        <Run Text="{Binding CursorX, Mode=OneWay}" />
                        <Run Text=", " />
                        <Run Text="{Binding CursorY, Mode=OneWay}" />
                    </TextBlock>
                </StackPanel>

                <!-- Magnifier Preview -->
                <GroupBox Header="Screen Magnifier" Margin="0,0,0,12">
                    <Border Background="{DynamicResource ControlBackgroundBrush}" CornerRadius="4" Padding="8"
                            HorizontalAlignment="Left" Width="310" Height="310">
                        <Image Source="{Binding MagnifierImage}" 
                               RenderOptions.BitmapScalingMode="NearestNeighbor"
                               Stretch="Uniform" />
                    </Border>
                </GroupBox>

                <!-- Zoom Control -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                    <TextBlock Text="Zoom:" VerticalAlignment="Center" Margin="0,0,8,0" />
                    <Slider Value="{Binding MagnifierZoom}" Minimum="2" Maximum="10" Width="200"
                            TickFrequency="1" IsSnapToTickEnabled="True" />
                    <TextBlock Text="{Binding MagnifierZoom, StringFormat={}{0}x}" Margin="8,0,0,0" VerticalAlignment="Center" />
                </StackPanel>

                <!-- Color History -->
                <GroupBox Header="Color History">
                    <ItemsControl ItemsSource="{Binding ColorHistory}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Width="32" Height="32" Margin="2" CornerRadius="3"
                                        BorderBrush="#FF555555" BorderThickness="1"
                                        ToolTip="{Binding}">
                                    <Border.Background>
                                        <SolidColorBrush Color="{Binding}" />
                                    </Border.Background>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </GroupBox>
            </StackPanel>

            <!-- Right: Color Info -->
            <GroupBox Grid.Column="1" Header="Selected Color">
                <StackPanel Margin="8">
                    <!-- Color Swatch -->
                    <Border Height="80" CornerRadius="4" Margin="0,0,0,12"
                            BorderBrush="#FF555555" BorderThickness="1"
                            Background="{Binding ColorBrush}" />

                    <!-- Color Values -->
                    <GroupBox Header="HEX" Margin="0,0,0,8">
                        <StackPanel Orientation="Horizontal" Margin="4">
                            <TextBox Text="{Binding HexColor, Mode=OneWay}" IsReadOnly="True"
                                     FontFamily="Consolas" FontSize="14" Width="120"
                                     Background="Transparent" Foreground="{DynamicResource WindowForegroundBrush}"
                                     BorderThickness="0" />
                            <Button Content="ðŸ“‹" Command="{Binding CopyHexCommand}" Padding="6,2"
                                    Background="#FF2196F3" Foreground="White" ToolTip="Copy HEX" />
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="RGB" Margin="0,0,0,8">
                        <StackPanel Orientation="Horizontal" Margin="4">
                            <TextBox Text="{Binding RgbColor, Mode=OneWay}" IsReadOnly="True"
                                     FontFamily="Consolas" FontSize="14" Width="180"
                                     Background="Transparent" Foreground="{DynamicResource WindowForegroundBrush}"
                                     BorderThickness="0" />
                            <Button Content="ðŸ“‹" Command="{Binding CopyRgbCommand}" Padding="6,2"
                                    Background="#FF2196F3" Foreground="White" ToolTip="Copy RGB" />
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="HSL">
                        <StackPanel Orientation="Horizontal" Margin="4">
                            <TextBox Text="{Binding HslColor, Mode=OneWay}" IsReadOnly="True"
                                     FontFamily="Consolas" FontSize="14" Width="180"
                                     Background="Transparent" Foreground="{DynamicResource WindowForegroundBrush}"
                                     BorderThickness="0" />
                            <Button Content="ðŸ“‹" Command="{Binding CopyHslCommand}" Padding="6,2"
                                    Background="#FF2196F3" Foreground="White" ToolTip="Copy HSL" />
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </GroupBox>
        </Grid>

        <!-- Status Bar -->
        <TextBlock Grid.Row="2" Text="{Binding StatusMessage}" Margin="0,4,0,0"
                   Foreground="{DynamicResource SecondaryTextBrush}" FontSize="11" />
    </Grid>
</UserControl>
