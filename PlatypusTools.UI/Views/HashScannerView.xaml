<UserControl x:Class="PlatypusTools.UI.Views.HashScannerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:PlatypusTools.UI.ViewModels"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:HashScannerViewModel}"
             AllowDrop="True"
             Drop="UserControl_Drop"
             DragOver="UserControl_DragOver">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="5"/>
            <RowDefinition Height="*" MinHeight="150"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- File Selection -->
        <GroupBox Header="ðŸ” File Hash Calculator" Grid.Row="0" Margin="0,0,0,10">
            <StackPanel Margin="5">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="File:" VerticalAlignment="Center" Margin="0,0,10,0" FontWeight="SemiBold"/>
                    <TextBox Grid.Column="1" Text="{Binding SelectedFile, UpdateSourceTrigger=PropertyChanged}" 
                             IsReadOnly="True" Margin="0,0,10,0" VerticalAlignment="Center"
                             ToolTip="Drag and drop a file here or click Browse"/>
                    <Button Grid.Column="2" Content="Browse..." Command="{Binding BrowseFileCommand}" 
                            Width="80" Margin="0,0,5,0" Padding="5,3"/>
                    <Button Grid.Column="3" Content="ðŸ“‚ Open" Command="{Binding OpenInExplorerCommand}" 
                            Width="70" Padding="5,3" ToolTip="Open file location in Explorer"/>
                </Grid>

                <!-- File Info -->
                <StackPanel Orientation="Horizontal" Margin="0,8,0,0" Visibility="{Binding FileName, Converter={StaticResource NullOrEmptyToVisibilityConverter}}">
                    <TextBlock Text="ðŸ“„" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding FileName}" FontWeight="SemiBold" Margin="0,0,15,0"/>
                    <TextBlock Text="Size:" Margin="0,0,5,0" Foreground="Gray"/>
                    <TextBlock Text="{Binding FileSizeFormatted}" Margin="0,0,15,0"/>
                    <TextBlock Text="Modified:" Margin="0,0,5,0" Foreground="Gray"/>
                    <TextBlock Text="{Binding FileModified, StringFormat='{}{0:yyyy-MM-dd HH:mm:ss}'}"/>
                </StackPanel>

                <!-- Options -->
                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                    <CheckBox Content="Uppercase hashes" IsChecked="{Binding UseUppercase}" Margin="0,0,20,0"/>
                    <Button Content="ðŸ”„ Calculate" Command="{Binding CalculateHashesCommand}" 
                            Width="100" Background="#FF4CAF50" Foreground="White" Margin="0,0,10,0"/>
                    <Button Content="Cancel" Command="{Binding CancelCommand}" 
                            Width="70" Background="#FFF44336" Foreground="White" Margin="0,0,10,0"
                            Visibility="{Binding IsCalculating, Converter={StaticResource BoolToVisibilityConverter}}"/>
                    <Button Content="âœ“ Verify" Command="{Binding VerifyHashCommand}" 
                            Width="70" Background="#FF2196F3" Foreground="White" Margin="0,0,10,0"
                            ToolTip="Verify a hash against calculated values"/>
                    <Button Content="Clear" Command="{Binding ClearCommand}" Width="60"/>
                </StackPanel>

                <!-- Progress -->
                <ProgressBar Value="{Binding Progress}" Height="4" Margin="0,8,0,0"
                             Visibility="{Binding IsCalculating, Converter={StaticResource BoolToVisibilityConverter}}"/>
            </StackPanel>
        </GroupBox>

        <!-- Hash Results -->
        <GroupBox Header="Hash Values" Grid.Row="1" Margin="0,0,0,10">
            <Grid Margin="5">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- MD5 -->
                <TextBlock Grid.Row="0" Grid.Column="0" Text="MD5:" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding MD5Hash, Mode=OneWay}" 
                         IsReadOnly="True" FontFamily="Consolas" Margin="0,0,5,5"/>
                <Button Grid.Row="0" Grid.Column="2" Content="ðŸ“‹" Command="{Binding CopyMD5Command}" 
                        Width="30" ToolTip="Copy MD5 hash" Margin="0,0,0,5"/>

                <!-- SHA1 -->
                <TextBlock Grid.Row="1" Grid.Column="0" Text="SHA1:" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SHA1Hash, Mode=OneWay}" 
                         IsReadOnly="True" FontFamily="Consolas" Margin="0,0,5,5"/>
                <Button Grid.Row="1" Grid.Column="2" Content="ðŸ“‹" Command="{Binding CopySHA1Command}" 
                        Width="30" ToolTip="Copy SHA1 hash" Margin="0,0,0,5"/>

                <!-- SHA256 -->
                <TextBlock Grid.Row="2" Grid.Column="0" Text="SHA256:" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding SHA256Hash, Mode=OneWay}" 
                         IsReadOnly="True" FontFamily="Consolas" Margin="0,0,5,5"/>
                <Button Grid.Row="2" Grid.Column="2" Content="ðŸ“‹" Command="{Binding CopySHA256Command}" 
                        Width="30" ToolTip="Copy SHA256 hash" Margin="0,0,0,5"/>

                <!-- SHA512 -->
                <TextBlock Grid.Row="3" Grid.Column="0" Text="SHA512:" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding SHA512Hash, Mode=OneWay}" 
                         IsReadOnly="True" FontFamily="Consolas" FontSize="10" Margin="0,0,5,5"
                         TextWrapping="Wrap" MaxHeight="40"/>
                <Button Grid.Row="3" Grid.Column="2" Content="ðŸ“‹" Command="{Binding CopySHA512Command}" 
                        Width="30" ToolTip="Copy SHA512 hash" Margin="0,0,0,5"/>

                <!-- CRC32 -->
                <TextBlock Grid.Row="4" Grid.Column="0" Text="CRC32:" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding CRC32Hash, Mode=OneWay}" 
                         IsReadOnly="True" FontFamily="Consolas" Margin="0,0,5,5"/>
                <Button Grid.Row="4" Grid.Column="2" Content="ðŸ“‹" Command="{Binding CopyCRC32Command}" 
                        Width="30" ToolTip="Copy CRC32 hash" Margin="0,0,0,5"/>

                <!-- Copy All -->
                <Button Grid.Row="5" Grid.Column="1" Content="ðŸ“‹ Copy All Hashes" Command="{Binding CopyAllCommand}"
                        HorizontalAlignment="Left" Width="140" Margin="0,5,0,0" Padding="5,3"/>
            </Grid>
        </GroupBox>

        <!-- GridSplitter -->
        <GridSplitter Grid.Row="2" Height="5" HorizontalAlignment="Stretch" 
                      Background="#CCCCCC" Cursor="SizeNS" ResizeDirection="Rows"/>

        <!-- Hash History -->
        <GroupBox Header="Hash History" Grid.Row="3" Margin="0,0,0,10">
            <DataGrid ItemsSource="{Binding HashHistory}" AutoGenerateColumns="False" 
                      CanUserAddRows="False" CanUserDeleteRows="False" IsReadOnly="True"
                      CanUserResizeColumns="True" CanUserSortColumns="True"
                      SelectionMode="Single" SelectionUnit="FullRow"
                      HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="File Name" Binding="{Binding FileName}" Width="200" MinWidth="100"/>
                    <DataGridTextColumn Header="Size" Binding="{Binding FileSizeFormatted}" Width="80"/>
                    <DataGridTextColumn Header="SHA256" Binding="{Binding SHA256}" Width="*" MinWidth="200">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontFamily" Value="Consolas"/>
                                <Setter Property="FontSize" Value="10"/>
                                <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                                <Setter Property="ToolTip" Value="{Binding SHA256}"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    <DataGridTextColumn Header="Calculated" Binding="{Binding CalculatedAt, StringFormat='{}{0:HH:mm:ss}'}" Width="80"/>
                </DataGrid.Columns>
            </DataGrid>
        </GroupBox>

        <!-- Status Bar -->
        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" VerticalAlignment="Center" 
                       FontWeight="SemiBold"/>
            
            <TextBlock Grid.Column="1" Text="Drag &amp; drop files here" Foreground="Gray" 
                       VerticalAlignment="Center" FontStyle="Italic"/>
        </Grid>
    </Grid>
</UserControl>
