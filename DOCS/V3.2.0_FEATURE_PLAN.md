# PlatypusTools v3.2.0 Feature Enhancement Plan

**Date**: January 2025  
**Status**: âœ… Released  
**Based on**: Comprehensive analysis of DOCS folder vs. actual codebase

---

## Executive Summary

After thorough analysis of the DOCS folder (TODO.md, IMPLEMENTATION_STATUS.md, AUDIO_PLAYER_IMPLEMENTATION_STATUS.md, etc.) and verification against the actual codebase, I've identified features that are:
- âœ… **Already Implemented** (docs outdated)
- âŒ **Not Yet Implemented** (candidates for v3.2.0)

### Docs vs Reality - Corrections

The following features were marked as "not implemented" in docs but **ARE ACTUALLY IMPLEMENTED**:

| Feature | Status | Location |
|---------|--------|----------|
| Crossfade | âœ… Exists | `AudioPlayerService.cs`, `AudioPlayerViewModel.cs` |
| Queue Persistence | âœ… Exists | `SaveQueueAsync()` / `LoadQueueAsync()` in AudioPlayerService |
| Drag-and-Drop Reorder | âœ… Exists | `AudioPlayerView.xaml.cs` line 1445 |
| Keyboard Shortcuts | âœ… Exists | `KeyboardShortcutService.cs`, `AudioPlayerView.xaml` |
| Plugin System (Core) | âœ… Exists | `PluginService.cs` with IPlugin, LoadPlugin, etc. |
| Library Indexing | âœ… Exists | `LibraryIndexService.cs`, `MetadataExtractorService.cs` |
| Atomic File Writer | âœ… Exists | `AtomicFileWriter.cs` |
| Path Canonicalizer | âœ… Exists | `PathCanonicalizer.cs` |

---

## v3.2.0 Implemented Features

### âœ… IMPLEMENTED IN v3.2.0

#### 1. Forensics Analyzer (NEW)
**Status**: âœ… Implemented  
**Location**: `ForensicsAnalyzerService.cs`, `ForensicsAnalyzerViewModel.cs`, `ForensicsAnalyzerView.xaml`
**Features**:
- Lightweight Mode (single core, ~100MB output, 24h logs)
- Deep Mode (multi-core, GB-scale output, 7 days logs)
- Memory analysis with process inspection
- File system analysis with SHA256 hashing
- Registry startup analysis
- Windows Event Log parsing
- Export report in JSON/text format

#### 2. Plugin Manager UI (TASK-163, TASK-164, TASK-169)
**Status**: âœ… Implemented  
**Location**: `PluginManagerView.xaml`, `PluginManagerViewModel.cs`  
**Features**:
- Browse installed plugins with status
- Install new plugins from file
- Enable/disable plugins
- Uninstall plugins
- Reload all plugins
- View plugin details

#### 3. Sleep Timer / Auto-Stop
**Status**: âœ… Implemented  
**Location**: `AudioPlayerViewModel.cs`, `AudioPlayerView.xaml`  
**Features**:
- Timer options: 15/30/45/60/90/120 minutes
- Countdown display in status bar
- Gradual fade-out before stop
- Cancel timer option

---

## Remaining Features for Future Versions  
**Implementation**:
- Add Sleep Timer button to audio player toolbar
- Timer dropdown: 15/30/60/90 minutes or end of track/queue
- Countdown display in status bar
- Fade-out option before stop

#### 4. Gapless Playback
**Status**: âŒ Not Implemented  
**Evidence**: Only exists in docs as "âŒ Not implemented"  
### ğŸ”´ HIGH PRIORITY - Future Versions

#### 1. Real Audio EQ (DSP Processing)
**Status**: âš ï¸ Partial - UI exists, doesn't affect audio  
**Evidence**: `AudioPlayerService.cs` has EQ settings that only affect visualization  
**Effort**: 8-10 hours  
**Implementation**:
- Integrate NAudio BiQuadFilter chain
- Apply EQ presets to actual audio output
- Bass/Mid/Treble should modify playback, not just visualizer

#### 2. Gapless Playback
**Status**: âŒ Not Implemented  
**Evidence**: Only exists in docs as "âŒ Not implemented"  
**Effort**: 6-8 hours  
**Implementation**:
- Pre-buffer next track before current ends
- Seamless transition without gap
- Works best with same sample rate tracks

#### 3. Transition Preview (TASK-047)
**Status**: âŒ Not Implemented  
**Evidence**: `TransitionPreviewWindow` not found in codebase  
**Effort**: 4-5 hours  
**Implementation**:
- Preview window for VideoMerge transitions
- Shows 5-second preview of transition effect
- Real-time slider to scrub through transition

### ğŸŸ¡ MEDIUM PRIORITY - Enhancement Features

#### 4. Synchronized Zoom/Pan for Comparison Viewer (TASK-062)
**Status**: âŒ Not Implemented  
**Evidence**: No matches for synchronized zoom/pan  
**Effort**: 4-6 hours  
**Implementation**:
- Link zoom/pan between original and enhanced images
- Toggle for sync on/off
- Useful for batch upscale quality review

#### 5. Per-Item Settings Override for Batch Upscale (TASK-053)
**Status**: âŒ Not Implemented  
**Evidence**: Only in TODO.md  
**Effort**: 3-4 hours  
**Implementation**:
- Right-click item â†’ Override Settings
- Per-file model/scale override
- Visual indicator for overridden items

#### 6. Tag Selection Checkboxes for Batch Metadata (TASK-072)
**Status**: âŒ Not Implemented  
**Evidence**: Only in TODO.md  
**Effort**: 2-3 hours  
**Implementation**:
- Checkboxes next to each metadata field
- Only apply checked fields
- Quick select all/none buttons

#### 7. Preview Before Apply for Batch Metadata (TASK-074)
**Status**: âŒ Not Implemented  
**Evidence**: Only in TODO.md  
**Effort**: 3-4 hours  
**Implementation**:
- Preview panel showing before/after
- Diff highlighting for changes
- Apply selected files only

#### 10. Delete from Disk for Audio Library
**Status**: âŒ Not Implemented  
**Evidence**: No DeleteFromDisk/RemoveFromDisk in codebase  
**Effort**: 2-3 hours  
**Implementation**:
- Context menu â†’ Delete from Disk
- Confirmation dialog with file list
- Send to Recycle Bin option
- Double-confirm for >20 items

### ğŸŸ¢ LOW PRIORITY - Nice to Have

#### 11. Scrolling Capture for Screenshot Tool (TASK-134)
**Status**: âŒ Not Implemented  
**Evidence**: No scrolling capture/stitching in codebase  
**Effort**: 12-16 hours (complex)  
**Implementation**:
- Capture visible area, auto-scroll, capture again
- Stitch captured images together
- Handle overlap detection

#### 12. Replay Gain Normalization
**Status**: âŒ Not Implemented  
**Evidence**: Only in docs  
**Effort**: 6-8 hours  
**Implementation**:
- Read ReplayGain tags from audio files
- Apply gain adjustment during playback
- Optional clipping prevention

#### 13. Sample Plugin (TASK-168)
**Status**: âŒ Not Implemented  
**Evidence**: Only in TODO.md  
**Effort**: 2-3 hours  
**Implementation**:
- Create `PlatypusTools.SamplePlugin` project
- Demonstrate IPlugin, IMenuPlugin, IFileProcessorPlugin
- Include README for plugin developers

#### 14. Plugin Sandboxing (TASK-167)
**Status**: âŒ Not Implemented  
**Evidence**: Only in TODO.md  
**Effort**: 10-15 hours (complex)  
**Implementation**:
- Load plugins in isolated AppDomain or AssemblyLoadContext
- Restrict file system access
- Crash isolation

---

## Recommended v3.2.0 Scope

Based on effort vs. impact analysis, here's the recommended scope:

### Phase 1: Quick Wins (4-6 hours total)
1. âœ… **Sleep Timer** (2-3h) - Easy, high user value
2. âœ… **Plugin Manager UI** (4-6h) - Backend exists, just need UI
3. âœ… **Tag Selection Checkboxes** (2-3h) - Simple enhancement

### Phase 2: Audio Enhancements (10-14 hours)
4. âœ… **Real Audio EQ** (8-10h) - High impact, NAudio DSP chain
5. âœ… **Delete from Disk** (2-3h) - Essential library management

### Phase 3: Comparison & Preview (8-10 hours)
6. âœ… **Transition Preview** (4-5h) - Video merge enhancement
7. âœ… **Synchronized Zoom/Pan** (4-6h) - Batch upscale improvement

### Deferred to v3.3.0+
- Gapless Playback (requires significant audio engine changes)
- Scrolling Capture (complex stitching algorithm)
- Plugin Sandboxing (security complexity)
- Replay Gain (low user demand)

---

## Implementation Order

| Order | Feature | Effort | Priority | Impact |
|-------|---------|--------|----------|--------|
| 1 | Sleep Timer | 2-3h | High | High |
| 2 | Plugin Manager UI | 4-6h | High | High |
| 3 | Delete from Disk | 2-3h | Medium | High |
| 4 | Real Audio EQ | 8-10h | High | High |
| 5 | Tag Selection Checkboxes | 2-3h | Medium | Medium |
| 6 | Transition Preview | 4-5h | Medium | Medium |
| 7 | Synchronized Zoom/Pan | 4-6h | Medium | Medium |
| 8 | Preview Before Apply | 3-4h | Medium | Medium |
| 9 | Per-Item Settings Override | 3-4h | Low | Medium |

**Total v3.2.0 Estimated Effort**: 35-45 hours

---

## Files to Create/Modify

### New Files
```
PlatypusTools.UI/
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ PluginManagerView.xaml
â”‚   â””â”€â”€ TransitionPreviewWindow.xaml
â”œâ”€â”€ ViewModels/
â”‚   â”œâ”€â”€ PluginManagerViewModel.cs
â”‚   â””â”€â”€ TransitionPreviewViewModel.cs
â””â”€â”€ Controls/
    â””â”€â”€ SleepTimerControl.xaml
```

### Modified Files
```
PlatypusTools.UI/
â”œâ”€â”€ Services/
â”‚   â””â”€â”€ AudioPlayerService.cs (add real EQ DSP)
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ AudioPlayerView.xaml (add sleep timer, delete)
â”‚   â”œâ”€â”€ BatchUpscaleView.xaml (sync zoom)
â”‚   â””â”€â”€ MetadataEditorView.xaml (tag checkboxes)
â””â”€â”€ ViewModels/
    â”œâ”€â”€ AudioPlayerViewModel.cs (sleep timer logic)
    â””â”€â”€ BatchUpscaleViewModel.cs (per-item override)
```

---

## Action Items

- [ ] Update TODO.md to reflect actual implementation status
- [ ] Remove outdated "not implemented" markers from docs
- [ ] Create GitHub issues for v3.2.0 features
- [ ] Prioritize based on user feedback

---

*Generated by comprehensive DOCS analysis*
