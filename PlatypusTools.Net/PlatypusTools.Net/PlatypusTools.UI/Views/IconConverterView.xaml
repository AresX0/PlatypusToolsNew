<UserControl x:Class="PlatypusTools.UI.Views.IconConverterView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:PlatypusTools.UI.ViewModels"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:IconConverterViewModel}">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Images Folder Selection -->
        <GroupBox Header="Source Images" Grid.Row="0" Margin="0,0,0,10">
            <StackPanel>
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="Images Folder:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBox Grid.Column="1" Text="{Binding ImagesFolder, UpdateSourceTrigger=PropertyChanged}" 
                             IsReadOnly="True" Margin="0,0,10,0"/>
                    <Button Grid.Column="2" Content="Browse Folder" Command="{Binding BrowseFolderCommand}" 
                            Width="120" Padding="5"/>
                </Grid>

                <StackPanel Orientation="Horizontal" Margin="5,5,5,10" HorizontalAlignment="Left">
                    <Button Content="Add Files" Command="{Binding AddFilesCommand}" Width="100" Margin="0,0,10,0" Padding="5"/>
                    <Button Content="Add Folder" Command="{Binding AddFolderCommand}" Width="100" Margin="0,0,10,0" Padding="5"/>
                    <Button Content="Clear List" Command="{Binding ClearListCommand}" Width="100" Padding="5"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- File List with Selection -->
        <GroupBox Header="Images to Convert" Grid.Row="1" Height="200" Margin="0,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="5">
                    <Button Content="Select All" Command="{Binding SelectAllCommand}" Width="80" Margin="0,0,5,0" Padding="3"/>
                    <Button Content="Select None" Command="{Binding SelectNoneCommand}" Width="80" Padding="3"/>
                </StackPanel>

                <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                    <DataGrid ItemsSource="{Binding FileList}" AutoGenerateColumns="False" 
                              CanUserAddRows="False" CanUserDeleteRows="False" Margin="5"
                              CanUserResizeColumns="True" CanUserSortColumns="True"
                              HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Disabled">
                        <DataGrid.Columns>
                            <DataGridCheckBoxColumn Header="Convert" Binding="{Binding Convert, UpdateSourceTrigger=PropertyChanged}" Width="70" CanUserResize="True" MinWidth="60"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name, Mode=OneWay}" Width="250" IsReadOnly="True" CanUserResize="True" MinWidth="100"/>
                            <DataGridTextColumn Header="Path" Binding="{Binding Path, Mode=OneWay}" Width="400" IsReadOnly="True" CanUserResize="True" MinWidth="150"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status, Mode=OneWay}" Width="150" IsReadOnly="True" CanUserResize="True" MinWidth="80"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </ScrollViewer>
            </Grid>
        </GroupBox>

        <!-- ICO Conversion Options -->
        <GroupBox Header="ICO Conversion" Grid.Row="2" Margin="0,0,0,10">
            <StackPanel Margin="5">
                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="Output Folder:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBox Grid.Column="1" Text="{Binding OutputFolder, UpdateSourceTrigger=PropertyChanged}" 
                             Margin="0,0,10,0"/>
                    <Button Grid.Column="2" Content="Browse" Command="{Binding BrowseFolderCommand}" 
                            Width="80" Padding="5"/>
                </Grid>

                <Grid Margin="0,0,0,10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="150"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="Output Name:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBox Grid.Column="1" Text="{Binding OutputName, UpdateSourceTrigger=PropertyChanged}" Margin="0,0,20,0"/>

                    <TextBlock Grid.Column="2" Text="Icon Size:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <ComboBox Grid.Column="3" SelectedValue="{Binding IconSize, UpdateSourceTrigger=PropertyChanged}">
                        <ComboBox.Items>
                            <ComboBoxItem Content="16" Tag="16"/>
                            <ComboBoxItem Content="24" Tag="24"/>
                            <ComboBoxItem Content="32" Tag="32"/>
                            <ComboBoxItem Content="48" Tag="48"/>
                            <ComboBoxItem Content="64" Tag="64"/>
                            <ComboBoxItem Content="128" Tag="128"/>
                            <ComboBoxItem Content="256" Tag="256" IsSelected="True"/>
                        </ComboBox.Items>
                    </ComboBox>
                </Grid>

                <CheckBox Content="Overwrite Existing" IsChecked="{Binding OverwriteExisting}" Margin="0,0,0,10"/>

                <StackPanel Orientation="Horizontal">
                    <Button Content="Convert to ICO" Command="{Binding ConvertToIcoCommand}" 
                            Width="120" Margin="0,0,10,0" Padding="5" FontWeight="Bold"/>
                    
                    <TextBlock Text="Format:" VerticalAlignment="Center" Margin="10,0,10,0"/>
                    <ComboBox SelectedItem="{Binding SelectedFormat, UpdateSourceTrigger=PropertyChanged}" Width="100" Margin="0,0,10,0">
                        <ComboBoxItem Content="PNG" IsSelected="True"/>
                        <ComboBoxItem Content="JPG"/>
                        <ComboBoxItem Content="BMP"/>
                        <ComboBoxItem Content="GIF"/>
                        <ComboBoxItem Content="TIFF"/>
                    </ComboBox>
                    
                    <Button Content="Convert Format" Command="{Binding ConvertFormatCommand}" 
                            Width="120" Padding="5"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- Status Bar -->
        <Border Grid.Row="3" Background="#F0F0F0" BorderBrush="#CCCCCC" BorderThickness="1" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" VerticalAlignment="Center" FontWeight="SemiBold"/>
                <Button Grid.Column="1" Content="Cancel" Command="{Binding CancelCommand}" 
                        Width="80" Padding="5" Visibility="{Binding IsConverting, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>
